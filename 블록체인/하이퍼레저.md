원장(ledger)
- 거래내역
- 하이퍼레저 페브릭은 블록을 연결한 블록체인과 전체상태의 두 개 DB로 구성됨


분산원장기술(Distributed Ledger Technology)
- 거래내역이 담긴 블록을 사슬처럼 연결하여 공유
- 공공 거래 장부라고 함

체인코드
- 스마트 컨트랙트라고 함
- 블록체인 네트워크 외부에 의해 호출되는 코드
- 전체상태의 일련 키-값 쌍에 대한 접근 및 수정 관리
- 피어노드에 설치되고 여러 채널로 인스턴스화 됨

트랜잭션
- 체인코드가 설치되거나 호출할 때 발생
- 블록체인 네트워크에서의 이벤트 단위

채널 
- 서로 다른 노드들을 묶는 역할을 함
- 채널을 통해 거래와 원장을 분기할 수 있음
- 하나의 채널에는 하나의 원장을 가짐
- 다른 채널의 체인코드 호출(invoke) 시 읽기만 가능
- 채널별 원장은 채널의 피어 간에 공유되며 거래 당사자는 해당 채널과 상호작용함
- 어플리케이션과 오더러, 피어로 구성됨


조직
- 네트워크 조직별 피어노드 권한 관리
- 네트워크의 참여자(클라이언트)의 접근 권한을 관리

오더러
- 블록을 생성하는 역할
- 네트워크 내 채널에 대한 구성정보를 소유
- 채널의 구성정보를 기반으로 전체시스템의 관리자 역할

Peer 노드
- 하이퍼래저 패브릭 네트워크를 구성하는 노드
- 네트워크 참여자들은 peer에 설치되어 있는 체인코드 실행요청을 통하여 peer에 저장된 원장을 열람 및 수정 가능

Endorsing Peer 노드
- 트랜잭션의 적절성 판단
- execution 역할

Committing Peer 노드
- Validation 역할
- 트랜잭션 확정 및 블록체인에 업데이트

Anchor Peer LE
- 채널 내의 대표역할
- 다른 조직의 peer와 통신하는 역할

Leader peer LE
- 조직내의 대표역할
- 최신블록 전달을 위해 오더러와 연결하고, 해당 블록을 다른 peer에게 전송하는 역할

MSP
- 블록체인 네트워크에 인증서비스 제공
- PKI(공개키 구조 기반)으로 사용
- 네트워크에 접속하는 클라이언트의 신원 확인 및 접근권한 제공

CA(Certificate Authority)
- MSP에서 암호화 인증을 위하여 필요한 인증 기관 임
- 공개키 인증서 및 개인키 발급

### 체인코드
#### 사용자 체인코드
- 개발자가 다루는 코드

#### 시스템 체인코드
- 체인코드 동작을 위해 처리 흐름 제어
- 패브릭 자체에서 제공

체인 코드 실행 시 
execution -> ordering -> validation

### 체인코드 종류

![[체인코드.png]]


### 하이퍼레저 페브릭 흐름도

![[패브릭 흐름도.png]]

- Transaction Proposal : Application이 트랜젝션 제안서를 엔도싱 피어노드로 보냄
- Execute Chain Code : 엔도싱 피어 노드는 트랜잭션 제안서가 잘 구성되어있는지 확인하고 서명이 유효한지 체크한 뒤 체인코드를 실행
- Proposal Response :  트랜잭션 생성 및 반환
- Submit Transaction : 트랜잭션 + RW Set + (엔도싱 피어노드들의 서명, 채널 ID) 오더링 서비스 노드에 전송
- Order Transaction : 트랜잭션이 들어오는 순서 정리 후 트랜잭션 블록을 엔도싱 피어 노드와 커미팅 피어 노드에게 전달
- Validate Transaction : 가 피어노드 : 보증 정책이 충족되었는지 확인 후 원장상태 변경 확인
- Ledger Commit : 유효성 검증된 트랜잭션 : 모든 피어 노드의 DB에 기록

